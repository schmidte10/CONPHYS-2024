---
title: "DataAnalysis_respirometry"
author: "Elliott Schmidt"
date: "2022-09-30"
output: html_document
---
# Load libraries
```{r loading_libraries, warnings = FALSE}
library(tidyverse) 
library(plyr)
library(dplyr)
library(ggplot2)
``` 
# Set working directory 
*Note:* working directory will be different for you and will depend on where you have saved files on local drive. 

```{r setup}
knitr::opts_knit$set(root.dir = "C:/Users/Elliott/OneDrive - James Cook University/PhD dissertation/Data/Local_adaptation/Chapter1_LocalAdaptation/")
```

# Import data 
```{r import data}
resp <- read.delim("./respirometry/SummaryData_2022_resp.txt")

# data seems to have loaded with two extract columns at the end 
# remove extract columns by name 

resp <- resp %>% select(-c("X","X.1"))
```

# Preparing data
```{r preparing data, warnings = FALSE}
resp = resp %>% 
  mutate(FISH_ID = factor(FISH_ID), 
          POPULATION = factor(POPULATION), 
          REGION = factor(REGION), 
          TEMPERATURE = factor(TEMPERATURE),
          RESTING_DATE = factor(RESTING_DATE), 
          RESTING_CHAMBER = factor(RESTING_CHAMBER), 
          RESTING_SYSTEM = factor(RESTING_SYSTEM), 
          RESTING_SUMP = factor(RESTING_SUMP), 
          RESTING_AM_PM = factor(RESTING_AM_PM), 
          RESTING_START_TIME = hms(RESTING_START_TIME),
          MAX_DATE = factor(MAX_DATE), 
          MAX_CHAMBER = factor(MAX_CHAMBER), 
          MAX_SYSTEM = factor(MAX_SYSTEM), 
          MAX_SUMP = factor(MAX_SUMP), 
          MAX_AM_PM = factor(MAX_AM_PM), 
          MAX_START_TIME = hms(MAX_START_TIME), 
          Swim.performance = factor(Swim.performance)) %>% 
  rename(MASS = WEIGHT)
```

# Exploratory data analysis 
```{r explatory data analysis}
ggplot(resp, aes(MASS, RESTING)) + 
  geom_point() + 
  geom_smooth(method = "lm")

ggplot(resp, aes(MASS, MAX)) + 
  geom_point() + 
  geom_smooth(method = "lm")

ggplot(resp, aes(MASS, NAS)) + 
  geom_point() + 
  geom_smooth(method = "lm")


ggplot(resp, aes(MASS, FAS)) + 
  geom_point() + 
  geom_smooth(method = "lm")
```
Negative relationships between mass and resting metabolic rate  
positive relationship between mass and maximum metabolic rate
No relationship between mass and net aerobic cope

```{r exploratory data analysis 2}
ggplot(resp, aes(REGION, RESTING)) + 
  geom_boxplot() +
  theme_classic() + 
  facet_grid(~TEMPERATURE)

ggplot(resp, aes(REGION, MAX)) + 
  geom_boxplot() +
  theme_classic() + 
  facet_grid(~TEMPERATURE)

ggplot(resp, aes(REGION, MASS)) + 
  geom_boxplot() +
  theme_classic() 

ggplot(resp, aes(REGION, RESTING_MgO2.hr)) + 
  geom_boxplot() +
  theme_classic() + 
  facet_grid(~TEMPERATURE)

ggplot(resp, aes(REGION, MAX_MgO2.hr)) + 
  geom_boxplot() +
  theme_classic() + 
  facet_grid(~TEMPERATURE) 

ggplot(resp, aes(REGION, NAS)) + 
  geom_boxplot() +
  theme_classic() + 
  facet_grid(~TEMPERATURE) 

ggplot(resp, aes(REGION, FAS)) + 
  geom_boxplot() +
  theme_classic() + 
  facet_grid(~TEMPERATURE) 
```